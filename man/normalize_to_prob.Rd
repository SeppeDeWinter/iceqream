% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/preprocess.R
\name{normalize_to_prob}
\alias{normalize_to_prob}
\title{Convert normalized ATAC data to probability-like values}
\usage{
normalize_to_prob(peaks, mat, prob1_thresh = NULL, const_quantile = 0.9)
}
\arguments{
\item{peaks}{A data frame with peak intervals and a logical 'const' column for constitutive peaks}

\item{mat}{Numeric matrix. The matrix to normalize (typically output from \code{normalize_const})}

\item{prob1_thresh}{Numeric or NULL. Signal threshold for probability = 1.
If NULL, calculated from constitutive peaks using const_quantile. Default: NULL}

\item{const_quantile}{Numeric. Quantile of constitutive peak values to use as threshold
when prob1_thresh is NULL. Default: 0.9}
}
\value{
A matrix with the same dimensions as the input, containing probability-like
values between 0 and 1
}
\description{
Transforms normalized ATAC-seq signals into probability-like values between 0 and 1,
using either a specified threshold or a quantile of constitutive peak values to
determine the maximum signal level.
}
\details{
The normalization process:
\enumerate{
\item Determines threshold for probability = 1 (either directly or from constitutive peaks)
\item Divides all values by this threshold
\item Caps values at 1
\item Applies min-max normalization to ensure full \link{0,1} range utilization
}
}
\section{Warning}{

If prob1_thresh is NULL, the peaks data frame must include a logical 'const' column.
The function will stop with an error if this column is missing.
}

\examples{
\dontrun{
# Using constitutive peak quantile
prob_mat <- normalize_to_prob(peaks_df, norm_const_mat)

# Using specific threshold
prob_mat <- normalize_to_prob(
    peaks_df,
    norm_const_mat,
    prob1_thresh = 0.75,
    const_quantile = 0.95
)
}

}
\seealso{
\code{\link{normalize_regional}}, \code{\link{normalize_const}} for prior normalization steps
}
