% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/preprocess.R
\name{plot_cell_type_normalization_scatter}
\alias{plot_cell_type_normalization_scatter}
\title{Create comparison scatter plots showing normalization effects between two cell types}
\usage{
plot_cell_type_normalization_scatter(
  obj,
  cell_type1,
  cell_type2,
  peaks_f = NULL
)
}
\arguments{
\item{obj}{List. A preprocessed ATAC-seq data object, output from \code{\link{preprocess_data}}}

\item{cell_type1}{Character. Name of the first cell type to plot (x-axis)}

\item{cell_type2}{Character. Name of the second cell type to plot (y-axis)}

\item{peaks_f}{Logical vector or NULL. Optional filter for selecting specific peaks.
If NULL, all peaks are used. Default: NULL}
}
\value{
A ggplot2 object containing four scatter plots arranged horizontally using
patchwork, showing the progression of normalization effects
}
\description{
Creates a series of scatter plots comparing ATAC-seq signals between two cell types
at each stage of the normalization process. The plots show raw signals, regional
normalization, constitutive peak normalization, and probability normalization in
a single combined figure.
}
\details{
The function creates four scatter plots showing:
\enumerate{
\item Raw ATAC signal (log2 transformed)
\item Region-normalized signal
\item Constitutive peak-normalized signal
\item Probability-normalized signal
}

Each plot includes:
\itemize{
\item Points colored by peak type (constitutive vs variable)
\item A diagonal reference line
}
}
\examples{
\dontrun{
# Basic usage comparing two cell types
p <- plot_cell_type_normalization_scatter(
    atac_obj,
    cell_type1 = "CD4_T",
    cell_type2 = "CD8_T"
)

# Plot specific peaks using a filter
p <- plot_cell_type_normalization_scatter(
    atac_obj,
    cell_type1 = "CD4_T",
    cell_type2 = "CD8_T",
    peaks_f = atac_obj$peaks$tss_dist < 1000
)
}

}
\seealso{
\code{\link{normalize_regional}}, \code{\link{normalize_const}},
\code{\link{normalize_to_prob}} for the normalization methods being visualized
}
